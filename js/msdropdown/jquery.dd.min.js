// MSDropDown - jquery.dd.js
// author: Marghoob Suleman - http://www.marghoobsuleman.com/
// Date: 10 Nov, 2012
// Version: 3.2
// Revision: 21
// web: www.marghoobsuleman.com
/*
// msDropDown is free jQuery Plugin: you can redistribute it and/or modify
// it under the terms of the either the MIT License or the Gnu General Public License (GPL) Version 2
*/
var msBeautify=msBeautify||{};(function($){function dd(element,settings){var _settings=$.extend(!0,{byJson:{data:null,selectedIndex:0,name:null,size:0,multiple:!1,width:250},mainCSS:"dd",height:120,visibleRows:7,rowHeight:0,showIcon:!0,zIndex:9999,useSprite:!1,animStyle:"slideDown",event:"click",openDirection:"auto",jsonTitle:!0,style:"",disabledOpacity:.7,disabledOptionEvents:!0,childWidth:0,enableCheckbox:!1,checkboxNameSuffix:"_mscheck",append:"",prepend:"",on:{create:null,open:null,close:null,add:null,remove:null,change:null,blur:null,click:null,dblclick:null,mousemove:null,mouseover:null,mouseout:null,focus:null,mousedown:null,mouseup:null}},settings),_this=this,_holderId={postElementHolder:"_msddHolder",postID:"_msdd",postTitleID:"_title",postTitleTextID:"_titleText",postChildID:"_child"},_styles={dd:_settings.mainCSS,ddTitle:"ddTitle",arrow:"arrow arrowoff",ddChild:"ddChild",ddTitleText:"ddTitleText",disabled:"disabled",enabled:"enabled",ddOutOfVision:"ddOutOfVision",borderTop:"borderTop",noBorderTop:"noBorderTop",selected:"selected",divider:"divider",optgroup:"optgroup",optgroupTitle:"optgroupTitle",description:"description",label:"ddlabel",hover:"hover",disabledAll:"disabledAll"},_styles_i={li:"_msddli_",borderRadiusTp:"borderRadiusTp",ddChildMore:"border shadow",fnone:"fnone"},_isList=!1,_isMultiple=!1,_isDisabled=!1,_cacheElement={},_element,_orginial,_isOpen=!1,DOWN_ARROW=40,UP_ARROW=38,LEFT_ARROW=37,RIGHT_ARROW=39,ESCAPE=27,ENTER=13,ALPHABETS_START=47,SHIFT=16,CONTROL=17,_shiftHolded=!1,_controlHolded=!1,_lastTarget=null,_forcedTrigger=!1,_oldSelected,_isCreated=!1,_doc=document,_checkDataSetting=function(){_settings.mainCSS=$("#"+_element).data("maincss")||_settings.mainCSS,_settings.visibleRows=$("#"+_element).data("visiblerows")||_settings.visibleRows,0==$("#"+_element).data("showicon")&&(_settings.showIcon=$("#"+_element).data("showicon")),_settings.useSprite=$("#"+_element).data("usesprite")||_settings.useSprite,_settings.animStyle=$("#"+_element).data("animstyle")||_settings.animStyle,_settings.event=$("#"+_element).data("event")||_settings.event,_settings.openDirection=$("#"+_element).data("opendirection")||_settings.openDirection,_settings.jsonTitle=$("#"+_element).data("jsontitle")||_settings.jsonTitle,_settings.disabledOpacity=$("#"+_element).data("disabledopacity")||_settings.disabledOpacity,_settings.childWidth=$("#"+_element).data("childwidth")||_settings.childWidth,_settings.enableCheckbox=$("#"+_element).data("enablecheckbox")||_settings.enableCheckbox,_settings.checkboxNameSuffix=$("#"+_element).data("checkboxnamesuffix")||_settings.checkboxNameSuffix,_settings.append=$("#"+_element).data("append")||_settings.append,_settings.prepend=$("#"+_element).data("prepend")||_settings.prepend},getElement=function(a){return void 0===_cacheElement[a]&&(_cacheElement[a]=_doc.getElementById(a)),_cacheElement[a]},_getIndex=function(a){var b=_getPostID("postChildID");return $("#"+b+" li."+_styles_i.li).index(a)},_createByJson=function(){if(_settings.byJson.data){var validData=["description","image","title"];try{element.id||(element.id="dropdown"+msBeautify.counter),_settings.byJson.data=eval(_settings.byJson.data);var id="msdropdown"+msBeautify.counter++,obj={};obj.id=id,obj.name=_settings.byJson.name||element.id,_settings.byJson.size>0&&(obj.size=_settings.byJson.size),obj.multiple=_settings.byJson.multiple;for(var oSelect=_createElement("select",obj),i=0;_settings.byJson.data.length>i;i++){var current=_settings.byJson.data[i],opt=new Option(current.text,current.value);for(var p in current)if("text"!=p.toLowerCase()){var key=-1!=$.inArray(p.toLowerCase(),validData)?"data-":"";opt.setAttribute(key+p,current[p])}oSelect.options[i]=opt}getElement(element.id).appendChild(oSelect),oSelect.selectedIndex=_settings.byJson.selectedIndex,$(oSelect).css({width:_settings.byJson.width+"px"}),element=oSelect}catch(e){throw"There is an error in json data."}}},_construct=function(){_createByJson(),element.id||(element.id="msdrpdd"+msBeautify.counter++),_element=element.id,_this._element=_element,_checkDataSetting(),_isDisabled=getElement(_element).disabled;var a=_settings.enableCheckbox;Boolean(a)===!0&&(getElement(_element).multiple=!0,_settings.enableCheckbox=!0),_isList=getElement(_element).size>1||1==getElement(_element).multiple?!0:!1,_isList&&(_isMultiple=getElement(_element).multiple),_mergeAllProp(),_createLayout(),_updateProp("uiData",_getDataAndUI()),_updateProp("selectedOptions",$("#"+_element+" option:selected"))},_getPostID=function(a){return _element+_holderId[a]},_getInternalStyle=function(a){var b=void 0===a.style?"":a.style.cssText;return b},_parseOption=function(opt){var imagePath="",title="",description="",value=-1,text="",className="",imagecss="";if(void 0!==opt){var attrTitle=opt.title||"";if(""!=attrTitle){var reg=/^\{.*\}$/,isJson=reg.test(attrTitle);if(isJson&&_settings.jsonTitle)var obj=eval("["+attrTitle+"]");title=isJson&&_settings.jsonTitle?obj[0].title:title,description=isJson&&_settings.jsonTitle?obj[0].description:description,imagePath=isJson&&_settings.jsonTitle?obj[0].image:attrTitle,imagecss=isJson&&_settings.jsonTitle?obj[0].imagecss:imagecss}text=opt.text||"",value=opt.value||"",className=opt.className||"",title=$(opt).prop("data-title")||$(opt).data("title")||title||"",description=$(opt).prop("data-description")||$(opt).data("description")||description||"",imagePath=$(opt).prop("data-image")||$(opt).data("image")||imagePath||"",imagecss=$(opt).prop("data-imagecss")||$(opt).data("imagecss")||imagecss||""}var o={image:imagePath,title:title,description:description,value:value,text:text,className:className,imagecss:imagecss};return o},_createElement=function(a,b,c){var d=_doc.createElement(a);if(b)for(var e in b)switch(e){case"style":d.style.cssText=b[e];break;default:d[e]=b[e]}return c&&(d.innerHTML=c),d},_hideOriginal=function(){var a=_getPostID("postElementHolder");if(0==$("#"+a).length){var b={style:"height: 0px;overflow: hidden;position: absolute;",className:_styles.ddOutOfVision};b.id=a;var c=_createElement("div",b);$("#"+_element).after(c),$("#"+_element).appendTo($("#"+a))}else $("#"+a).css({height:0,overflow:"hidden",position:"absolute"})},_createWrapper=function(){var a={className:_styles.dd+" ddcommon borderRadius"},b=_getInternalStyle(getElement(_element)),c=$("#"+_element).outerWidth();a.style="width: "+c+"px;",b.length>0&&(a.style=a.style+""+b),a.id=_getPostID("postID");var d=_createElement("div",a);return d},_createTitle=function(){var a;a=getElement(_element).selectedIndex>=0?getElement(_element).options[getElement(_element).selectedIndex]:{value:"",text:""};var b="",c="",d=$("#"+_element).data("usesprite");d&&(_settings.useSprite=d),0!=_settings.useSprite&&(b=" "+_settings.useSprite,c=" "+a.className);var e=_createElement("div",{className:_styles.ddTitle+b+" "+_styles_i.borderRadiusTp}),f=_createElement("span",{className:_styles.divider}),g=_createElement("span",{className:_styles.arrow}),h=_getPostID("postTitleID"),i=_createElement("span",{className:_styles.ddTitleText+c,id:h}),j=_parseOption(a),k=j.image,l=j.text||"";if(""!=k&&_settings.showIcon){var m=_createElement("img");m.src=k,""!=j.imagecss&&(m.className=j.imagecss+" ")}var n=_createElement("span",{className:_styles.label},l);e.appendChild(f),e.appendChild(g),m&&i.appendChild(m),i.appendChild(n),e.appendChild(i);var o=_createElement("span",{className:_styles.description},j.description);return i.appendChild(o),e},_createFilterBox=function(){var a=_getPostID("postTitleTextID"),b=_createElement("input",{id:a,type:"text",value:"",autocomplete:"off",className:"text shadow borderRadius",style:"display: none"});return b},_createChild=function(a){var b={},c=_getInternalStyle(a);c.length>0&&(b.style=c);var d=a.disabled?_styles.disabled:_styles.enabled;d=a.selected?d+" "+_styles.selected:d,d=d+" "+_styles_i.li,b.className=d,0!=_settings.useSprite&&(b.className=d+" "+a.className);var e=_createElement("li",b),f=_parseOption(a);""!=f.title&&(e.title=f.title);var g=f.image;if(""!=g&&_settings.showIcon){var h=_createElement("img");h.src=g,""!=f.imagecss&&(h.className=f.imagecss+" ")}if(""!=f.description)var i=_createElement("span",{className:_styles.description},f.description);var j=a.text||"",k=_createElement("span",{className:_styles.label},j);if(_settings.enableCheckbox===!0){var l=_createElement("input",{type:"checkbox",name:_element+_settings.checkboxNameSuffix+"[]",value:a.value||""});e.appendChild(l),_settings.enableCheckbox===!0&&(l.checked=a.selected?!0:!1)}h&&e.appendChild(h),e.appendChild(k),i?e.appendChild(i):h&&(h.className=h.className+_styles_i.fnone);var m=_createElement("div",{className:"clear"});return e.appendChild(m),e},_createChildren=function(){var a=_getPostID("postChildID"),b={className:_styles.ddChild+" ddchild_ "+_styles_i.ddChildMore,id:a};b.style=0==_isList?"z-index: "+_settings.zIndex:"z-index:1";var c=$("#"+_element).data("childwidth")||_settings.childWidth;c&&(b.style=(b.style||"")+";width:"+c);var d=_createElement("div",b),e=_createElement("ul");0!=_settings.useSprite&&(e.className=_settings.useSprite);for(var f=getElement(_element).children,g=0;f.length>g;g++){var i,h=f[g];if("optgroup"==h.nodeName.toLowerCase()){i=_createElement("li",{className:_styles.optgroup});var j=_createElement("span",{className:_styles.optgroupTitle},h.label);i.appendChild(j);for(var k=h.children,l=_createElement("ul"),m=0;k.length>m;m++){var n=_createChild(k[m]);l.appendChild(n)}i.appendChild(l)}else i=_createChild(h);e.appendChild(i)}return d.appendChild(e),d},_childHeight=function(a){var b=_getPostID("postChildID");if(a)return-1==a?$("#"+b).css({height:"auto",overflow:"auto"}):$("#"+b).css("height",a+"px"),!1;var c;if(getElement(_element).options.length>_settings.visibleRows){var d=parseInt($("#"+b+" li:first").css("padding-bottom"))+parseInt($("#"+b+" li:first").css("padding-top"));0===_settings.rowHeight&&($("#"+b).css({visibility:"hidden",display:"block"}),_settings.rowHeight=Math.round($("#"+b+" li:first").height()),$("#"+b).css({visibility:"visible"}),_isList&&_settings.enableCheckbox!==!0||$("#"+b).css({display:"none"})),c=(_settings.rowHeight+d)*_settings.visibleRows}else _isList&&(c=$("#"+_element).height());return c},_applyChildEvents=function(){var a=_getPostID("postChildID");$("#"+a).on("click",function(a){return _isDisabled===!0?!1:(a.preventDefault(),a.stopPropagation(),_isList&&_bind_on_events(),void 0)}),$("#"+a+" li."+_styles.enabled).on("click",function(a){"input"!==a.target.nodeName.toLowerCase()&&_close(this)}),$("#"+a+" li."+_styles.enabled).on("mousedown",function(b){if(_isDisabled===!0)return!1;if(_oldSelected=$("#"+a+" li."+_styles.selected),_lastTarget=this,b.preventDefault(),b.stopPropagation(),_settings.enableCheckbox===!0&&"input"===b.target.nodeName.toLowerCase()&&(_controlHolded=!0),_isList===!0)if(_isMultiple)if(_shiftHolded===!0){$(this).addClass(_styles.selected);var c=$("#"+a+" li."+_styles.selected),d=_getIndex(this);if(c.length>1){var e=$("#"+a+" li."+_styles_i.li),f=_getIndex(c[0]),g=_getIndex(c[1]);d>g&&(f=d,g+=1);for(var h=Math.min(f,g);Math.max(f,g)>=h;h++){var i=e[h];$(i).hasClass(_styles.enabled)&&$(i).addClass(_styles.selected)}}}else if(_controlHolded===!0){if($(this).toggleClass(_styles.selected),_settings.enableCheckbox===!0){var j=this.childNodes[0];j.checked=!j.checked}}else $("#"+a+" li."+_styles.selected).removeClass(_styles.selected),$("#"+a+" input:checkbox").prop("checked",!1),$(this).addClass(_styles.selected),_settings.enableCheckbox===!0&&(this.childNodes[0].checked=!0);else $("#"+a+" li."+_styles.selected).removeClass(_styles.selected),$(this).addClass(_styles.selected);else $("#"+a+" li."+_styles.selected).removeClass(_styles.selected),$(this).addClass(_styles.selected)}),$("#"+a+" li."+_styles.enabled).on("mouseenter",function(a){return _isDisabled===!0?!1:(a.preventDefault(),a.stopPropagation(),null!=_lastTarget&&_isMultiple&&($(this).addClass(_styles.selected),_settings.enableCheckbox===!0&&(this.childNodes[0].checked=!0)),void 0)}),$("#"+a+" li."+_styles.enabled).on("mouseover",function(){return _isDisabled===!0?!1:($(this).addClass(_styles.hover),void 0)}),$("#"+a+" li."+_styles.enabled).on("mouseout",function(){return _isDisabled===!0?!1:($("#"+a+" li."+_styles.hover).removeClass(_styles.hover),void 0)}),$("#"+a+" li."+_styles.enabled).on("mouseup",function(b){if(_isDisabled===!0)return!1;b.preventDefault(),b.stopPropagation(),_settings.enableCheckbox===!0&&(_controlHolded=!1);var c=$("#"+a+" li."+_styles.selected).length;_forcedTrigger=_oldSelected.length!=c||0==c?!0:!1,_fireAfterItemClicked(),_unbind_on_events(),_bind_on_events(),_lastTarget=null}),0==_settings.disabledOptionEvents&&($("#"+a+" li."+_styles_i.li).on("click",function(){return _isDisabled===!0?!1:(fireOptionEventIfExist(this,"click"),void 0)}),$("#"+a+" li."+_styles_i.li).on("mouseenter",function(){return _isDisabled===!0?!1:(fireOptionEventIfExist(this,"mouseenter"),void 0)}),$("#"+a+" li."+_styles_i.li).on("mouseover",function(){return _isDisabled===!0?!1:(fireOptionEventIfExist(this,"mouseover"),void 0)}),$("#"+a+" li."+_styles_i.li).on("mouseout",function(){return _isDisabled===!0?!1:(fireOptionEventIfExist(this,"mouseout"),void 0)}),$("#"+a+" li."+_styles_i.li).on("mousedown",function(){return _isDisabled===!0?!1:(fireOptionEventIfExist(this,"mousedown"),void 0)}),$("#"+a+" li."+_styles_i.li).on("mouseup",function(){return _isDisabled===!0?!1:(fireOptionEventIfExist(this,"mouseup"),void 0)}))},_removeChildEvents=function(){var a=_getPostID("postChildID");$("#"+a).off("click"),$("#"+a+" li."+_styles.enabled).off("mouseenter"),$("#"+a+" li."+_styles.enabled).off("click"),$("#"+a+" li."+_styles.enabled).off("mouseover"),$("#"+a+" li."+_styles.enabled).off("mouseout"),$("#"+a+" li."+_styles.enabled).off("mousedown"),$("#"+a+" li."+_styles.enabled).off("mouseup")},_applyEvents=function(){var a=_getPostID("postID");_getPostID("postChildID"),$("#"+a).on(_settings.event,function(a){return _isDisabled===!0?!1:(fireEventIfExist("click"),a.preventDefault(),a.stopPropagation(),_open(a),void 0)}),_applyChildEvents(),$("#"+a).on("dblclick",on_dblclick),$("#"+a).on("mousemove",on_mousemove),$("#"+a).on("mouseenter",on_mouseover),$("#"+a).on("mouseleave",on_mouseout),$("#"+a).on("mousedown",on_mousedown),$("#"+a).on("mouseup",on_mouseup)},_fixedForList=function(){var a=_getPostID("postID"),b=_getPostID("postChildID");if(_isList===!0&&_settings.enableCheckbox===!1)$("#"+a+" ."+_styles.ddTitle).hide(),$("#"+b).css({display:"block",position:"relative"});else{_settings.enableCheckbox===!1&&(_isMultiple=!1),$("#"+a+" ."+_styles.ddTitle).show(),$("#"+b).css({display:"none",position:"absolute"});var c=$("#"+b+" li."+_styles.selected)[0];$("#"+b+" li."+_styles.selected).removeClass(_styles.selected);var d=_getIndex($(c).addClass(_styles.selected));_setValue(d)}_childHeight(_childHeight())},_fixedForDisabled=function(){var a=_getPostID("postID");1==_isDisabled?_settings.disabledOpacity:1,_isDisabled===!0?$("#"+a).addClass(_styles.disabledAll):$("#"+a).removeClass(_styles.disabledAll)},_fixedSomeUI=function(){var a=_getPostID("postTitleTextID");$("#"+a).on("keyup",_applyFilters),_fixedForList(),_fixedForDisabled()},_createLayout=function(){var a=_createWrapper(),b=_createTitle();a.appendChild(b);var c=_createFilterBox();a.appendChild(c);var d=_createChildren();a.appendChild(d),$("#"+_element).after(a),_hideOriginal(),_fixedSomeUI(),_applyEvents();var e=_getPostID("postChildID");""!=_settings.append&&$("#"+e).append(_settings.append),""!=_settings.prepend&&$("#"+e).prepend(_settings.prepend),"function"==typeof _settings.on.create&&_settings.on.create.apply(_this,arguments)},_selectMutipleOptions=function(a){for(var b=_getPostID("postChildID"),c=a||$("#"+b+" li."+_styles.selected),d=0;c.length>d;d++){var e=_getIndex(c[d]);getElement(_element).options[e].selected="selected"}_setValue(c)},_fireAfterItemClicked=function(){var a=_getPostID("postChildID"),b=$("#"+a+" li."+_styles.selected);(_isMultiple&&(_shiftHolded||_controlHolded)||_forcedTrigger)&&(getElement(_element).selectedIndex=-1);var c;if(0==b.length?c=-1:b.length>1?_selectMutipleOptions(b):c=_getIndex($("#"+a+" li."+_styles.selected)),(getElement(_element).selectedIndex!=c||_forcedTrigger)&&1>=b.length){if(_forcedTrigger=!1,has_handler("change"),getElement(_element).selectedIndex=c,_setValue(c),"function"==typeof _settings.on.change){var e=_getDataAndUI();_settings.on.change(e.data,e.ui)}$("#"+_element).trigger("change")}},_setValue=function(a,b){if(void 0!==a){var c,d,e;if(-1==a)c=-1,d="",e="",_updateTitleUI(-1);else if("object"!=typeof a){var f=getElement(_element).options[a];getElement(_element).selectedIndex=a,c=a,d=_parseOption(f),e=a>=0?getElement(_element).options[a].text:"",_updateTitleUI(void 0,d),d=d.value}else c=b&&b.index||getElement(_element).selectedIndex,d=b&&b.value||getElement(_element).value,e=b&&b.text||getElement(_element).options[getElement(_element).selectedIndex].text||"",_updateTitleUI(c);_updateProp("selectedIndex",c),_updateProp("value",d),_updateProp("selectedText",e),_updateProp("children",getElement(_element).children),_updateProp("uiData",_getDataAndUI()),_updateProp("selectedOptions",$("#"+_element+" option:selected"))}},has_handler=function(a){var b={byElement:!1,byJQuery:!1,hasEvent:!1},c=$("#"+_element);try{null!==c.prop("on"+a)&&(b.hasEvent=!0,b.byElement=!0)}catch(d){}var e;return e="function"==typeof $._data?$._data(c[0],"events"):c.data("events"),e&&e[a]&&(b.hasEvent=!0,b.byJQuery=!0),b},_bind_on_events=function(){_unbind_on_events(),$("body").on("click",_close),$(document).on("keydown",on_keydown),$(document).on("keyup",on_keyup)},_unbind_on_events=function(){$("body").off("click",_close),$(document).off("keydown",on_keydown),$(document).off("keyup",on_keyup)},_applyFilters=function(){var a=_getPostID("postChildID"),b=_getPostID("postTitleTextID"),c=getElement(b).value;0==c.length?($("#"+a+" li:hidden").show(),_childHeight(_childHeight())):($("#"+a+" li").hide(),$("#"+a+" li:Contains('"+c+"')").show(),$("#"+a+" li:visible").length<=_settings.visibleRows&&_childHeight(-1))},_showFilterBox=function(){var a=_getPostID("postTitleTextID");$("#"+a+":hidden").length>0&&0==_controlHolded&&($("#"+a+":hidden").show().val(""),getElement(a).focus())},_hideFilterBox=function(){var a=_getPostID("postTitleTextID");$("#"+a+":visible").length>0&&($("#"+a+":visible").hide(),getElement(a).blur())},on_keydown=function(a){switch(_getPostID("postTitleTextID"),a.keyCode){case DOWN_ARROW:case RIGHT_ARROW:a.preventDefault(),a.stopPropagation(),_next();break;case UP_ARROW:case LEFT_ARROW:a.preventDefault(),a.stopPropagation(),_previous();break;case ESCAPE:case ENTER:a.preventDefault(),a.stopPropagation(),_close();break;case SHIFT:_shiftHolded=!0;break;case CONTROL:_controlHolded=!0;break;default:a.keyCode>=ALPHABETS_START&&_isList===!1&&_showFilterBox()}return _isDisabled===!0?!1:(fireEventIfExist("keydown"),void 0)},on_keyup=function(a){switch(a.keyCode){case SHIFT:_shiftHolded=!1;break;case CONTROL:_controlHolded=!1}return _isDisabled===!0?!1:(fireEventIfExist("keyup"),void 0)},on_dblclick=function(){return _isDisabled===!0?!1:(fireEventIfExist("dblclick"),void 0)},on_mousemove=function(){return _isDisabled===!0?!1:(fireEventIfExist("mousemove"),void 0)},on_mouseover=function(a){return _isDisabled===!0?!1:(a.preventDefault(),fireEventIfExist("mouseover"),void 0)},on_mouseout=function(a){return _isDisabled===!0?!1:(a.preventDefault(),fireEventIfExist("mouseout"),void 0)},on_mousedown=function(){return _isDisabled===!0?!1:(fireEventIfExist("mousedown"),void 0)},on_mouseup=function(){return _isDisabled===!0?!1:(fireEventIfExist("mouseup"),void 0)},option_has_handler=function(a,b){var c={byElement:!1,byJQuery:!1,hasEvent:!1};void 0!=$(a).prop("on"+b)&&(c.hasEvent=!0,c.byElement=!0);var d=$(a).data("events");return d&&d[b]&&(c.hasEvent=!0,c.byJQuery=!0),c},fireOptionEventIfExist=function(a,b){if(0==_settings.disabledOptionEvents){var c=getElement(_element).options[_getIndex(a)];if(option_has_handler(c,b).hasEvent===!0){if(option_has_handler(c,b).byElement===!0&&c["on"+b](),option_has_handler(c,b).byJQuery===!0)switch(b){case"keydown":case"keyup":break;default:$(c).trigger(b)}return!1}}},fireEventIfExist=function(a){if("function"==typeof _settings.on[a]&&_settings.on[a].apply(this,arguments),has_handler(a).hasEvent===!0){if(has_handler(a).byElement===!0&&getElement(_element)["on"+a](),has_handler(a).byJQuery===!0)switch(a){case"keydown":case"keyup":break;default:$("#"+_element).trigger(a)}return!1}},_scrollToIfNeeded=function(a){var b=_getPostID("postChildID");if(a=void 0!==a?a:$("#"+b+" li."+_styles.selected),a.length>0){var c=parseInt($(a).position().top),d=parseInt($("#"+b).height());if(c>d){var e=c+$("#"+b).scrollTop()-d/2;$("#"+b).animate({scrollTop:e},500)}}},_next=function(){function e(a){return a+=1,a>b.length?a:$(b[a]).hasClass(_styles.enabled)===!0?a:a=e(a)}var a=_getPostID("postChildID"),b=$("#"+a+" li:visible."+_styles_i.li),c=$("#"+a+" li:visible."+_styles.selected);c=0==c.length?b[0]:c;var d=$("#"+a+" li:visible."+_styles_i.li).index(c);b.length-1>d&&(d=e(d),b.length>d&&(_shiftHolded&&_isList&&_isMultiple||$("#"+a+" ."+_styles.selected).removeClass(_styles.selected),$(b[d]).addClass(_styles.selected),_updateTitleUI(d),1==_isList&&_fireAfterItemClicked(),_scrollToIfNeeded($(b[d]))),_isList||_adjustOpen())},_previous=function(){function f(a){return a-=1,0>a?a:$(c[a]).hasClass(_styles.enabled)===!0?a:a=f(a)}var a=_getPostID("postChildID"),b=$("#"+a+" li:visible."+_styles.selected),c=$("#"+a+" li:visible."+_styles_i.li),d=$("#"+a+" li:visible."+_styles_i.li).index(b[0]);if(d>=0){if(d=f(d),d>=0&&(_shiftHolded&&_isList&&_isMultiple||$("#"+a+" ."+_styles.selected).removeClass(_styles.selected),$(c[d]).addClass(_styles.selected),_updateTitleUI(d),1==_isList&&_fireAfterItemClicked(),0>=parseInt($(c[d]).position().top+$(c[d]).height()))){var e=$("#"+a).scrollTop()-$("#"+a).height()-$(c[d]).height();$("#"+a).animate({scrollTop:e},500)}_isList||_adjustOpen()}},_adjustOpen=function(){var a=_getPostID("postID"),b=_getPostID("postChildID"),c=$("#"+a).offset(),d=$("#"+a).height(),e=$(window).height(),f=$(window).scrollTop(),g=$("#"+b).height(),h=$("#"+a).height();if(Math.floor(g+d+c.top)>e+f||"alwaysup"==_settings.openDirection.toLowerCase()){h=g,$("#"+b).css({top:"-"+h+"px",display:"block",zIndex:_settings.zIndex}),$("#"+a).removeClass("borderRadius borderRadiusTp").addClass("borderRadiusBtm");var h=$("#"+b).offset().top;-10>h&&($("#"+b).css({top:parseInt($("#"+b).css("top"))-h+20+f+"px",zIndex:_settings.zIndex}),$("#"+a).removeClass("borderRadiusBtm borderRadiusTp").addClass("borderRadius"))}else $("#"+b).css({top:h+"px",zIndex:_settings.zIndex}),$("#"+a).removeClass("borderRadius borderRadiusBtm").addClass("borderRadiusTp");$.browser.msie&&7>=parseInt($.browser.version)&&($("div.ddcommon").css("zIndex",_settings.zIndex-10),$("#"+a).css("zIndex",_settings.zIndex+5))},_open=function(){if(_isDisabled===!0)return!1;_getPostID("postID");var c=_getPostID("postChildID");if(_isOpen)"mouseover"!==_settings.event&&_close();else{_isOpen=!0,""!=msBeautify.oldDiv&&$("#"+msBeautify.oldDiv).css({display:"none"}),msBeautify.oldDiv=c,$("#"+c+" li:hidden").show(),_adjustOpen();var d=_settings.animStyle;if(""==d||"none"==d){if($("#"+c).css({display:"block"}),_scrollToIfNeeded(),"function"==typeof _settings.on.open){var e=_getDataAndUI();_settings.on.open(e.data,e.ui)}}else $("#"+c)[d]("fast",function(){if(_scrollToIfNeeded(),"function"==typeof _settings.on.open){var a=_getDataAndUI();_settings.on.open(a.data,a.ui)}});_bind_on_events()}},_close=function(){_isOpen=!1;var b=_getPostID("postID"),c=_getPostID("postChildID");if((_isList===!1||_settings.enableCheckbox===!0)&&($("#"+c).css({display:"none"}),$("#"+b).removeClass("borderRadiusTp borderRadiusBtm").addClass("borderRadius")),_unbind_on_events(),"function"==typeof _settings.on.close){var d=_getDataAndUI();_settings.on.close(d.data,d.ui)}_hideFilterBox(),_childHeight(_childHeight()),$("#"+c).css({zIndex:1})},_mergeAllProp=function(){_orginial=$.extend(!0,{},$("#"+_element));for(var a in _orginial)"function"!=typeof _orginial[a]&&(_this[a]=_orginial[a]);_this.selectedText=_orginial.selectedIndex>=0?_orginial.options[_orginial.selectedIndex].text:"",_this.version=msBeautify.version.msDropdown,_this.author=msBeautify.author},_getDataAndUIByOption=function(a){if(null!=a&&a!==void 0){var b=_getPostID("postChildID"),c=_parseOption(a),d=$("#"+b+" li."+_styles_i.li+":eq("+a.index+")");return{data:c,ui:d,option:a,index:a.index}}return null},_getDataAndUI=function(){var c,d,e,f,a=_getPostID("postChildID"),b=getElement(_element);if(-1==b.selectedIndex)c=null,d=null,e=null,f=-1;else if(d=$("#"+a+" li."+_styles.selected),d.length>1){for(var g=[],h=[],j=0;d.length>j;j++){var k=_getIndex(d[j]);g.push(k),h.push(b.options[k])}c=g,e=h,f=g}else e=b.options[b.selectedIndex],c=_parseOption(e),f=b.selectedIndex;return{data:c,ui:d,index:f,option:e}},_updateTitleUI=function(a,b){var c=_getPostID("postTitleID"),d={};if(-1==a)d.text="&nbsp;",d.className="",d.description="",d.image="";else if(a!==void 0){var e=getElement(_element).options[a];d=_parseOption(e)}else d=b;$("#"+c).find("."+_styles.label).html(d.text),getElement(c).className=_styles.ddTitleText+" "+d.className,""!=d.description?$("#"+c).find("."+_styles.description).html(d.description).show():$("#"+c).find("."+_styles.description).html("").hide();var f=$("#"+c).find("img");f.length>0&&$(f).remove(),""!=d.image&&_settings.showIcon&&(f=_createElement("img",{src:d.image}),$("#"+c).prepend(f),""!=d.imagecss&&(f.className=d.imagecss+" "),""==d.description&&(f.className=f.className+_styles_i.fnone))},_updateProp=function(a,b){_this[a]=b},_updateUI=function(a,b,c){var d=_getPostID("postChildID"),e=!1;switch(a){case"add":var g,f=_createChild(b||getElement(_element).options[c]);if(g=3==arguments.length?c:$("#"+d+" li."+_styles_i.li).length-1,0>g||!g)$("#"+d+" ul").append(f);else{var h=$("#"+d+" li."+_styles_i.li)[g];$(h).before(f)}_removeChildEvents(),_applyChildEvents(),null!=_settings.on.add&&_settings.on.add.apply(this,arguments);break;case"remove":e=$($("#"+d+" li."+_styles_i.li)[c]).hasClass(_styles.selected),$("#"+d+" li."+_styles_i.li+":eq("+c+")").remove();var i=$("#"+d+" li."+_styles.enabled);if(1==e&&i.length>0){$(i[0]).addClass(_styles.selected);var j=$("#"+d+" li."+_styles_i.li).index(i[0]);_setValue(j)}0==i.length&&_setValue(-1),$("#"+d+" li."+_styles_i.li).length<_settings.visibleRows&&!_isList&&_childHeight(-1),null!=_settings.on.remove&&_settings.on.remove.apply(this,arguments)}};this.act=function(){var a=arguments[0];switch(Array.prototype.shift.call(arguments),a){case"add":_this.add.apply(this,arguments);break;case"remove":_this.remove.apply(this,arguments);break;default:try{getElement(_element)[a].apply(getElement(_element),arguments)}catch(b){}}},this.add=function(){var a,b,c,d,e,f=arguments[0];"string"==typeof f?(a=f,b=a,opt=new Option(a,b)):(a=f.text||"",b=f.value||a,c=f.title||"",d=f.image||"",e=f.description||"",opt=new Option(a,b),$(opt).data("description",e),$(opt).data("image",d),$(opt).data("title",c)),arguments[0]=opt,getElement(_element).add.apply(getElement(_element),arguments),_updateProp("children",getElement(_element).children),_updateProp("length",getElement(_element).length),_updateUI("add",opt,arguments[1])},this.remove=function(a){getElement(_element).remove(a),_updateProp("children",getElement(_element).children),_updateProp("length",getElement(_element).length),_updateUI("remove",void 0,a)},this.set=function(a,b){if(a===void 0||b===void 0)return!1;a=""+a;try{_updateProp(a,b)}catch(c){}switch(a){case"size":getElement(_element)[a]=b,0==b&&(getElement(_element).multiple=!1),_isList=getElement(_element).size>1||1==getElement(_element).multiple?!0:!1,_fixedForList();break;case"multiple":getElement(_element)[a]=b,_isList=getElement(_element).size>1||1==getElement(_element).multiple?!0:!1,_isMultiple=getElement(_element).multiple,_fixedForList(),_updateProp(a,b);break;case"disabled":getElement(_element)[a]=b,_isDisabled=b,_fixedForDisabled();break;case"selectedIndex":case"value":getElement(_element)[a]=b;var d=_getPostID("postChildID");$("#"+d+" li."+_styles_i.li).removeClass(_styles.selected),$($("#"+d+" li."+_styles_i.li)[getElement(_element).selectedIndex]).addClass(_styles.selected),_setValue(getElement(_element).selectedIndex);break;case"length":var d=_getPostID("postChildID");getElement(_element).length>b&&(getElement(_element)[a]=b,0==b?($("#"+d+" li."+_styles_i.li).remove(),_setValue(-1)):($("#"+d+" li."+_styles_i.li+":gt("+(b-1)+")").remove(),0==$("#"+d+" li."+_styles.selected).length&&$("#"+d+" li."+_styles.enabled+":eq(0)").addClass(_styles.selected)),_updateProp(a,b),_updateProp("children",getElement(_element).children));break;case"id":break;default:try{getElement(_element)[a]=b,_updateProp(a,b)}catch(c){}}},this.get=function(a){return _this[a]||getElement(_element)[a]},this.visible=function(a){var b=_getPostID("postID");if(a===!0)$("#"+b).show();else{if(a!==!1)return"none"==$("#"+b).css("display")?!1:!0;$("#"+b).hide()}},this.debug=function(a){msBeautify.debug(a)},this.close=function(){_close()},this.open=function(){_open()},this.showRows=function(a){return a===void 0||0==a?!1:(_settings.visibleRows=a,_childHeight(_childHeight()),void 0)},this.visibleRows=this.showRows,this.on=function(a,b){$("#"+_element).on(a,b)},this.off=function(a,b){$("#"+_element).off(a,b)},this.addMyEvent=this.on,this.getData=function(){return _getDataAndUI()},this.namedItem=function(){var a=getElement(_element).namedItem.apply(getElement(_element),arguments);return _getDataAndUIByOption(a)},this.item=function(){var a=getElement(_element).item.apply(getElement(_element),arguments);return _getDataAndUIByOption(a)},this.setIndexByValue=function(a){this.set("value",a)},this.destory=function(){_getPostID("postElementHolder");var b=_getPostID("postID");$("#"+b+", #"+b+" *").off(),$("#"+b).remove(),$("#"+_element).parent().replaceWith($("#"+_element)),$("#"+_element).data("dd",null)},_construct()}msBeautify={version:{msDropdown:"3.2"},author:"Marghoob Suleman",counter:20,debug:function(a){a!==!1?$(".ddOutOfVision").css({height:"auto",position:"relative"}):$(".ddOutOfVision").css({height:"0px",position:"absolute"})},oldDiv:"",create:function(a,b,c){c=c||"dropdown";var d;switch(c.toLowerCase()){case"dropdown":case"select":d=$(a).msDropdown(b).data("dd")}return d}},$.msDropDown={},$.msDropdown={},$.extend(!0,$.msDropDown,msBeautify),$.extend(!0,$.msDropdown,msBeautify),void 0===$.fn.prop&&($.fn.prop=$.fn.attr),void 0===$.fn.on&&($.fn.on=$.fn.bind,$.fn.off=$.fn.unbind),$.expr[":"].Contains="function"==typeof $.expr.createPseudo?$.expr.createPseudo(function(a){return function(b){return $(b).text().toUpperCase().indexOf(a.toUpperCase())>=0}}):function(a,b,c){return $(a).text().toUpperCase().indexOf(c[3].toUpperCase())>=0},$.fn.extend({msDropDown:function(a){return this.each(function(){if(!$(this).data("dd")){var b=new dd(this,a);$(this).data("dd",b)}})}}),$.fn.msDropdown=$.fn.msDropDown})(jQuery);